<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>a2g.Core: $title</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">a2g.Core
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">adventure game engine with lots of static checking</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('Glossary.html','');
</script>
<div id="doc-content">
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="game-engine"></a>
game-engine</h2>
<p>The game engine part of the project is not very complicated. HTML/js already provides images, text manipulation, mouse handlers. The slow nature of the adventure game also lends itself to the web, making an adventure game one of the easier web games to write.</p>
<h2><a class="anchor" id="lots-of-static-checking"></a>
lots-of-static-checking</h2>
<p>Static checking is a way of picking up errors in <a class="el" href="Glossary.html#game-code">game-code</a>, without needing to run the game. In a2g, this is provided by compiling the *.java files. There are two areas of an adventure <a class="el" href="Glossary.html#game-code">game-code</a> that can benefit greatly from static checking:</p>
<ol type="1">
<li>Adventure games often need large handlers to handle all the possible combinations of verbs and objects in the game.<ul>
<li>such command are coded, and handled in a switch statement.</li>
<li>this enables compile error if the same command is handled twice</li>
<li>even get compile errror if both "Use A with B" is listed and "Use B with A".</li>
</ul>
</li>
<li>Game scripts can often get out of sync with the image resources.<ul>
<li>this is minimised by generating a java enum for all objects, inventory items, and animations.</li>
<li>and having <a class="el" href="Glossary.html#game-code">game-code</a> only access these items using only the enum values.</li>
<li>this way, a compiler error will be generated when using a deleted or renamed resource.</li>
<li>these enums are generated by the same <a class="el" href="Glossary.html#generator">generator</a> .exe that compresses the images, and makes LoadAPI modules.</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="game-code"></a>
game-code</h2>
<p>In this doc, "game-code" is the term used to refer to implementations of the <a class="el" href="QuickLinks.html#SceneAPI">SceneAPI</a>. This is to distinguish it from <a class="el" href="Glossary.html#game-engine">game-engine</a> code. Perhaps "game specific code" is a better term, or "game script".</p>
<h2><a class="anchor" id="a-java"></a>
a-java</h2>
<p>a.java is created by <a class="el" href="Glossary.html#generator">generator</a> in each of the <a class="el" href="Glossary.html#universe-folders">universe-folders</a>, at the following location: </p>
<div class="fragment"><pre class="fragment">...\&lt;universe-folder&gt;\_00_Animations\a.java
</pre></div><p> Whats follows is an example of its contents: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">public</span> <span class="keyword">class </span>a
{
..
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_BLANK = 545159322;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_INITIAL = 518411548;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_TALK_BACK = 4883804;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_TALK_FRONT = 1734717428;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_TALK_LEFT = 25921253;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_TALK_RIGHT = 641969397;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_WALK_BACK = 55215452;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_WALK_FORWARD = -1659309275;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_WALK_LEFT = 76252901;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> GUYBRUSH_WALK_RIGHT = -1505514250;
 ..
 }
</pre></div><h2><a class="anchor" id="o-java"></a>
o-java</h2>
<p>An o.java is created by <a class="el" href="Glossary.html#generator">generator</a> in each of the <a class="el" href="Glossary.html#psd-folders">psd-folders</a> that contain "_Main" in the name </p>
<div class="fragment"><pre class="fragment">...\&lt;universe-folder&gt;\_Town_Main\o.java
</pre></div><p> Whats follows is an example of its contents: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">public</span> <span class="keyword">class </span>i
{
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> STARRY_SKY = 1899;
  .
  .
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> TREE_SILHOUETTE = 1855;
}
</pre></div><h2><a class="anchor" id="i-java"></a>
i-java</h2>
<p>An i.java is created by <a class="el" href="Glossary.html#generator">generator</a> in each of the <a class="el" href="Glossary.html#psd-folders">psd-folders</a> that contain "_Inventory" in the name </p>
<div class="fragment"><pre class="fragment">...\&lt;universe-folder&gt;\_Part1_Inventory\i.java
</pre></div><p> Whats follows is an example of its contents: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">public</span> <span class="keyword">class </span>i
{
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> WALLET = 1899;
  .
  .
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> LOTTERY_TICKET = 1855;
}
</pre></div><h2><a class="anchor" id="generator"></a>
generator</h2>
<p>generator.exe is the tool that takes an input folder containing a hierarchy of sub folders containing pngs:</p>
<ul>
<li>reconstructs the subfolders replacing the images with cropped versions of the images.</li>
<li>fills some of the folders (<a class="el" href="Glossary.html#resolution-folders">resolution-folders</a>) with matching pairs of XXXLoader.java files XXXBundle.java files.</li>
<li>creates <a class="el" href="Glossary.html#o-java">o-java</a> files</li>
<li>creates <a class="el" href="Glossary.html#i-java">i-java</a> files</li>
<li>creates <a class="el" href="Glossary.html#a-java">a-java</a> files</li>
</ul>
<h2><a class="anchor" id="visuals"></a>
visuals</h2>
<p>'visuals' is the name of the output folder that <a class="el" href="Glossary.html#generator">generator</a> .exe creates. It copies the structure of whatever folder was used as input: either <a class="el" href="Glossary.html#sourcegwt">sourcegwt</a> or <a class="el" href="Glossary.html#sourceswing">sourceswing</a>, and generates some .java files along the way.</p>
<h2><a class="anchor" id="sourcegwt"></a>
sourcegwt</h2>
<p>If the rootfolder containing all the input game images stored as <a class="el" href="Glossary.html#pngs">pngs</a> is called "sourcegwt", then <a class="el" href="Glossary.html#generator">generator</a> .exe will generate the resultant XXXLoader.java and XXXBundle.java files so they use GWT libraries. <br/>
 The output will be generated in a folder called <a class="el" href="Glossary.html#visuals">visuals</a>. <br/>
 If Swing is the required output format, then <a class="el" href="Glossary.html#sourceswing">sourceswing</a> must be used instead.</p>
<h2><a class="anchor" id="sourceswing"></a>
sourceswing</h2>
<p>If the rootfolder containing all the input game images stored as <a class="el" href="Glossary.html#pngs">pngs</a> is called "sourceswing", then <a class="el" href="Glossary.html#generator">generator</a> .exe will generate the resultant XXXLoader.java and XXXBundle.java files so they use Swing libraries. <br/>
 The output will be generated in a folder called <a class="el" href="Glossary.html#visuals">visuals</a>. <br/>
 If GWT is the required output format, then <a class="el" href="Glossary.html#sourcegwt">sourcegwt</a> must be used instead.</p>
<h2><a class="anchor" id="universe-folders"></a>
universe-folders</h2>
<p>These sit inside of the <a class="el" href="Glossary.html#sourcegwt">sourcegwt</a> or <a class="el" href="Glossary.html#sourceswing">sourceswing</a> folder.<br/>
 And have <a class="el" href="Glossary.html#psd-folders">psd-folders</a> sitting inside of them.<br/>
 <br/>
 These are probably the least necessary enforced folder type. These exist because sometimes games get so big, that it creates a real compile burden on gwt. So sometimes it's good to have a folder that you can exclude from compilation <br/>
 Requirements:</p>
<ul>
<li>Needs to be able to be used as a Java package name.</li>
</ul>
<h2><a class="anchor" id="psd-folders"></a>
psd-folders</h2>
<p>These sit inside of <a class="el" href="Glossary.html#universe-folders">universe-folders</a>.<br/>
 And have <a class="el" href="Glossary.html#resolution-folders">resolution-folders</a> sit inside of them.<br/>
 <br/>
 Psd-folders folders are named so because each one can be used to store the output from single psd. A PSD is a Photoshop Document, which is basically an image where different objects in that image are split up in to different layers, and treated as separate objects. Each layers, does infact, correspond to a single <a class="el" href="QuickLinks.html#SceneObject">SceneObject</a> inside a2g. But you won't find those layers as subfolders of the psd-folder, there is another important lot of folders that need to be inserted below psd-folders: <a class="el" href="Glossary.html#resolution-folders">resolution-folders</a>. This is because each layer can be rendered out at different resolutions. Even if a game only support a single resolution, for a2g to support different resolutions easily, a2g needs to insist upon <a class="el" href="Glossary.html#resolution-folders">resolution-folders</a> existing between psd-folders and <a class="el" href="Glossary.html#object-folders">object-folders</a>. <br/>
 <br/>
 If, instead, the images come from a 3D authoring package, then this folder would most likely represent rendering output from a single camera: since all the output from a single camera, when composited, creates a coherent scene. <br/>
 <br/>
 Requirements:</p>
<ul>
<li>Needs to be able to be used as a Java package name.</li>
<li>Needs to contain "_Main" if an <a class="el" href="Glossary.html#o-java">o-java</a> is required to be generated.</li>
<li>Needs to contain "_Inventory" if its an inventory - whereby an <a class="el" href="Glossary.html#i-java">i-java</a> needs to be generated.</li>
</ul>
<h2><a class="anchor" id="resolution-folders"></a>
resolution-folders</h2>
<p>These sit inside <a class="el" href="Glossary.html#psd-folders">psd-folders</a>.<br/>
 And they have <a class="el" href="Glossary.html#object-folders">object-folders</a> sitting inside of them.<br/>
 <br/>
 Resolution-folders are named so because they specify a particular resolution.<br/>
 <br/>
 There are no naming requirements for resolution-folders. To load a file with a different resolution, the <a class="el" href="Glossary.html#a2g-client">a2g-client</a> needs to call <a class="el" href="QuickLinks.html#setScene">setScene</a> with an implementation of the <a class="el" href="QuickLinks.html#SceneAPI">SceneAPI</a> whose onFillLoadList implementation mentions only image resources of a certain resolution. See also <a class="el" href="Glossary.html#arbitrary-resolutions">arbitrary-resolutions</a> <br/>
 <br/>
 Requirements:</p>
<ul>
<li>Needs to be able to be used as a Java package name. It might be useful to name the subfolders after the resolution that the images within are targetted to, in <b>pixels</b>.</li>
</ul>
<h2><a class="anchor" id="object-folders"></a>
object-folders</h2>
<p>These sit inside <a class="el" href="Glossary.html#resolution-folders">resolution-folders</a>.<br/>
 And they have <a class="el" href="Glossary.html#animation-folders">animation-folders</a> sitting inside of them.<br/>
 <br/>
 Requirements:</p>
<ul>
<li>Needs to be able to be used as a Java package name.</li>
<li>The object must are prefixed with underscore("_"), then two digits, then another underscore("_")</li>
<li>The two digits are used as the drawing order of objects in the scene. eg the most foreground prefix is _99_ eg the back most prefix is _00_</li>
<li>The name coming after the prefix must be able to be used in a java enum, ie consecutive series of letters. Incidentally, the name found after the prefix are to be used as the <a class="el" href="Glossary.html#TextualId">TextualId</a> of the <b>object</b>.</li>
</ul>
<h2><a class="anchor" id="animation-folders"></a>
animation-folders</h2>
<p>These sit inside <a class="el" href="Glossary.html#object-folders">object-folders</a>.<br/>
 And they have <a class="el" href="Glossary.html#pngs">pngs</a> sitting inside of them.<br/>
 <br/>
 Requirements:</p>
<ul>
<li>Needs to be able to be used as a Java package name.</li>
<li>More importantly, the name must be able to be used in a java enum, ie consecutive series of letters. Incidentally, the name is also used as the <a class="el" href="Glossary.html#TextualId">TextualId</a> of the <b>animation</b>. <br/>
</li>
</ul>
<h2><a class="anchor" id="pngs"></a>
pngs</h2>
<p>png is the image format that all images must be stored as. <br/>
 <br/>
 Requirements:</p>
<ul>
<li>pngs must be named so that when sorted descendingly, the frames are in animation order</li>
<li>If there's only one in a particular folder, then that's not an issue.</li>
</ul>
<h2><a class="anchor" id="a2g-client"></a>
a2g-client</h2>
<p>A2g is not a standalone library, or API. It needs to be hosted. It can be hosted in either: <a class="el" href="Glossary.html#GWT">GWT</a> or <a class="el" href="Glossary.html#Swing">Swing</a>. And each client needs to make several calls to a2g, at the right time, and also handle several events from a2g. See also <a class="el" href="Glossary.html#how-to-write-a-swing-host">how-to-write-a-swing-host</a>.</p>
<h2><a class="anchor" id="loading-of-images"></a>
loading-of-images</h2>
<p>If all images were loaded first before the game is played, then the initial load needed to loaded the game would take forever. So to keep the initial load as small as possible, each scene is responsible for loading only the images that it needs. <br/>
 Internally, in GWT, this is done with a GWT technology called <a class="el" href="Glossary.html#CodeSplitting">CodeSplitting</a>. <br/>
 These images are then loaded with a progress bar, to keep the user informed. <br/>
 Also, the size of these images is reduced by using further compression on top of PNG compression. <br/>
 Internally, in GWT, this is done with a GWT technology called <a class="el" href="Glossary.html#ClientBundles">ClientBundles</a>. <br/>
 Using Client Bundles for images in an adventure games also means that people can't second guess the game by viewing all of the images it downloads. It is still possible to view the contents of a Client Bundle, since its not encrypted, but it is a lot harder than using straight uncompressed images.</p>
<h2><a class="anchor" id="loading-of-scene-files"></a>
loading-of-scene-files</h2>
<p>The loading of scene files is not done in a2g but since all the info needed to run a <a class="el" href="QuickLinks.html#Scene">Scene</a> is factored in to a single class, then this class can use a GWT Technology called code splitting to ensure that a particular <a class="el" href="QuickLinks.html#Scene">Scene</a> is only loaded when it is needed.</p>
<h2><a class="anchor" id="easy-debugging"></a>
easy-debugging</h2>
<p>Even javascript programmers agree that it's easier debugging a java desktop application, or applet than it is debugging javascript. <br/>
 A2g offers the ability to test in Swing, and so most of your debugging can be done in a java desktop application. <br/>
 GWT's debugging ability is, in fact, very good. Google have done a great job in bringing the convenience of desktop debugging to web development. <br/>
 Testing and debugging a full adventure game on the web does take much longer than on a desktop, since the images take much longer to download from the server, than straight from the local disk. So main development is best done in <a class="el" href="Glossary.html#Swing">Swing</a>. <br/>
</p>
<h2><a class="anchor" id="GWT"></a>
GWT</h2>
<p>GWT is a Google technology for using Java to generate javascript code <a href="https://developers.google.com/gwt">https://developers.google.com/gwt</a></p>
<h2><a class="anchor" id="CodeSplitting"></a>
CodeSplitting</h2>
<p>Code splitting is a GWT technology to allow some code to asynchronously download other code only when that code is needed. <a href="https://developers.google.com/we-toolkit/doc/latest/DevGuideCodeSplitting">https://developers.google.com/we-toolkit/doc/latest/DevGuideCodeSplitting</a></p>
<h2><a class="anchor" id="ClientBundles"></a>
ClientBundles</h2>
<p>Client bundles are a GWT technology to allow web resources to be downloaded more efficiently <a href="https://developers.google.com/we-toolkit/doc/latest/DevGuideClientBundle">https://developers.google.com/we-toolkit/doc/latest/DevGuideClientBundle</a></p>
<h2><a class="anchor" id="EventBus"></a>
EventBus</h2>
<p>EventBus a GWT pattern that manages the firing and subscribing of event interfaces. <a href="https://developers.google.com/we-toolkit/doc/latest/DevGuideEventBus">https://developers.google.com/we-toolkit/doc/latest/DevGuideEventBus</a></p>
<h2><a class="anchor" id="Maniac-Mansion-style"></a>
Maniac-Mansion-style</h2>
<h2>Maniac-Mansion-style</h2>
<p>Maniac Mansion was an influential Point n Click adventure game released in 1987. A2g does a few things differently from Maniac Mansion:</p>
<ul>
<li>no cut scenes. -style because the inventory uses images not plain text. So it's a bit more like Monkey Island style...except that it doesn't officially support scaling sprites. There may be a way <a class="el" href="Glossary.html#how-to-do-scaling-sprites">how-to-do-scaling-sprites</a>.</li>
</ul>
<h2><a class="anchor" id="simple"></a>
simple</h2>
<h2>Simple</h2>
<p>Keeping it simple means that the code will be easy for others to pick up and reuse/refactor. Without this, it is less useful as an opensource project. <br/>
 Simple doesn't necessarily mean lightweight. Something can be large and remain simple. Light weight isn't such a useful goal because for graphics intensive games the size of the game code will usully be small in comparison to the graphics. It's also unclear where to draw the line for lightweight: You could make something playable with a tiny amount of javascript. Lightweight isn't a goal of this project.</p>
<h2><a class="anchor" id="arbitrary-resolutions"></a>
arbitrary-resolutions</h2>
<p>By using viewport coordinates that are normalized to between 0.0 and 1.0, the single set of handlers for <a class="el" href="QuickLinks.html#onDoCommand">onDoCommand</a> can handle multiple resolution images. <br/>
 But since the implementation of <a class="el" href="QuickLinks.html#onFillLoadList">onFillLoadList</a> only supports a single resolution, then any concrete implementation can only ever deal with a single resolution. <br/>
 So if you need to support multiple resolutions, the best idea might be to have a common base class that implements <a class="el" href="QuickLinks.html#onDoCommand">onDoCommand</a> - and then have each <a class="el" href="QuickLinks.html#SceneAPI">SceneAPI</a> implementation for each resolution for that scene share the common base. <br/>
 There's a good reason why <a class="el" href="QuickLinks.html#onFillLoadList">onFillLoadList</a> doesn't support multiple resolutions: When the <a class="el" href="QuickLinks.html#onFillLoadList">onFillLoadList</a> references resources it pulls in extra code to that class. So to minimise this as much as possible, it only supports one resolution per concrete implementation. <br/>
</p>
<h2><a class="anchor" id="TextualId"></a>
TextualId</h2>
<p>TextualId properties are found on the following classes:</p>
<ul>
<li><a class="el" href="QuickLinks.html#SceneObject">SceneObject</a></li>
<li><a class="el" href="QuickLinks.html#InventoryItem">InventoryItem</a></li>
<li><a class="el" href="QuickLinks.html#Animation">Animation</a></li>
</ul>
<h2><a class="anchor" id="codes"></a>
codes</h2>
<p>Code properties are found on the following classes:</p>
<ul>
<li><a class="el" href="QuickLinks.html#SceneObject">SceneObject</a></li>
<li><a class="el" href="QuickLinks.html#InventoryItem">InventoryItem</a></li>
<li><a class="el" href="QuickLinks.html#Animation">Animation</a></li>
</ul>
<p>The previous three codes are used with the following methods, respectively:</p>
<ul>
<li>public SceneObject getObject(short code);</li>
<li>public Animation getAnimation(int code);</li>
<li>public InventoryItem getInventoryItem(int code);</li>
</ul>
<p>There is only ever one object mapped to one id at a time.</p>
<h2><a class="anchor" id="Swing"></a>
Swing</h2>
<p>Swing is Java technology for desktop apps. <a class="el" href="Glossary.html#how-to-write-a-swing-host">how-to-write-a-swing-host</a></p>
<h2><a class="anchor" id="how-to-do-scaling-sprites"></a>
how-to-do-scaling-sprites</h2>
<h2>How-to-do-scaling-sprites</h2>
<h2><a class="anchor" id="how-to-write-an-efficient-sceneloader"></a>
how-to-write-an-efficient-sceneloader</h2>
<h2>How-to-write-an-efficient-sceneloader</h2>
<h2><a class="anchor" id="how-to-write-a-swing-host"></a>
how-to-write-a-swing-host</h2>
<h2>how-to-write-a-Swing-host</h2>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Sun Nov 18 2012 11:54:14 for a2g.Core by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
